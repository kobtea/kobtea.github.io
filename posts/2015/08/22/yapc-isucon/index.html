<!doctype html>
<html>
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>YAPC::Asia Tokyo 2015 「ISUCONの勝ち方」メモ - kobtea.net</title>
  <meta name="description" content="eternal jojaku" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#cc9966" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  <link rel="icon" href="/favicon.ico" />
  <link rel="manifest" href="/site.webmanifest" />
  <meta name="twitter:card" content="summary"><meta name="twitter:title" content="YAPC::Asia Tokyo 2015 「ISUCONの勝ち方」メモ">
<meta name="twitter:description" content="インフラ力が上がると噂の競技ISUCONについて、ISUCON4優勝者自ら必勝法を公開。 そのうちスライドも公開して頂けるらしいが自分のために。 リンク [公式]ISUCON [公式]トーク情報 togetter スピーカー: @kazeburo さん 時間配分 競技全体では7時間 最初の1時間 まだ慌てるような時間じゃない 課題の理解、プロファイリング・チューニングの方向性を決める 最後の30分 再起動テストだけに使う 再起動の失敗はよくある 上記を考慮すると、実際の作業時間は5時間ほど 事前準備 chatroom (private) git repository 当日作業のリビジョン管理 見えてもいいならpublic wiki">

    <link
      rel="stylesheet"
      href="/css/main.min.1aca34cd23d909569e12863eef6a7b32bb2cc1db15395706a970ba4554387a4f.css"
      integrity="sha256-Gso0zSPZCVaeEoY&#43;72p7MrsswdsVOVcGqXC6RVQ4ek8="
    />
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/syntax.css"
  />
  <script
    defer
    src="https://use.fontawesome.com/releases/v6.4.2/js/all.js"
  ></script>
</head>

  <body>
    <header class="bg-primary">
  <nav
    class="mx-auto flex max-w-screen-lg flex-wrap items-center justify-between p-4 md:items-center"
  >
    <a class="text-xl font-bold text-white" href="https://kobtea.net/">
      <span class="">kobtea.net</span>
    </a>

    <ul class="flex flex-col md:flex-row">
      
        <li>
          <a href="/posts" class="block px-2 text-white"> Posts </a>
        </li>
      
    </ul>
  </nav>
</header>

    <section class="prose mx-auto max-w-screen-lg break-words p-4">
  <article>
    <section class="py-8">
      <h1>YAPC::Asia Tokyo 2015 「ISUCONの勝ち方」メモ</h1>
      <i class="fas fa-calendar-alt"></i>
      <time>2015-08-22 19:19</time>
      <span>&nbsp;</span>
      <i class="fas fa-tags"></i>
      
        <a href="/tags/conference">#conference</a>
      
    </section>

    <div class="rounded border">
      <aside><nav id="TableOfContents">
  <ul>
    <li><a href="#時間配分">時間配分</a></li>
    <li><a href="#事前準備">事前準備</a></li>
    <li><a href="#チューニングの進め方">チューニングの進め方</a>
      <ul>
        <li><a href="#1-課題の理解">1. 課題の理解</a></li>
        <li><a href="#2-プロファイリング">2. プロファイリング</a></li>
        <li><a href="#3-サーバ構成の把握">3. サーバ構成の把握</a></li>
        <li><a href="#4-チューニングの方向性を決める">4. チューニングの方向性を決める</a></li>
      </ul>
    </li>
    <li><a href="#チューニングのヒント">チューニングのヒント</a></li>
  </ul>
</nav></aside>
    </div>

    <p>インフラ力が上がると噂の競技ISUCONについて、ISUCON4優勝者自ら必勝法を公開。<br>
そのうちスライドも公開して頂けるらしいが自分のために。</p>
<p>リンク</p>
<ul>
<li><a href="http://isucon.net/">[公式]ISUCON</a></li>
<li><a href="http://yapcasia.org/2015/talk/show/86ebd212-fab3-11e4-8f5a-8ab37d574c3a">[公式]トーク情報</a></li>
<li><a href="http://togetter.com/li/863801">togetter</a></li>
</ul>
<p>スピーカー: @kazeburo さん</p>
<h2 id="時間配分">時間配分</h2>
<ul>
<li>競技全体では7時間</li>
<li>最初の1時間
<ul>
<li>まだ慌てるような時間じゃない</li>
<li>課題の理解、プロファイリング・チューニングの方向性を決める</li>
</ul>
</li>
<li>最後の30分
<ul>
<li>再起動テストだけに使う</li>
<li>再起動の失敗はよくある</li>
</ul>
</li>
<li>上記を考慮すると、実際の作業時間は5時間ほど</li>
</ul>
<h2 id="事前準備">事前準備</h2>
<ul>
<li>chatroom</li>
<li>(private) git repository
<ul>
<li>当日作業のリビジョン管理</li>
<li>見えてもいいならpublic</li>
</ul>
</li>
<li>wiki
<ul>
<li>すぐにペッと貼れて使える<code>my.cnf</code>などの設定ファイルを書いておく</li>
<li><code>sysctl</code>の設定方法などもググらなくて済むように書いておく</li>
</ul>
</li>
<li>技術選択
<ul>
<li>言語は何つかおうとか</li>
</ul>
</li>
<li>過去問
<ul>
<li>過去問大事</li>
<li><a href="http://isucon.net/archives/40724693.html">ISUCON4 予選問題の解説と講評 ＆ AMIの公開</a></li>
<li><a href="http://d.hatena.ne.jp/tmatsuu/20150815/1439643715">ISUCON予選突破の鍵は過去問を解くことなので無料で試せるようにした(Vagrant+Ansible)</a></li>
<li>EC2だとお金かかるけど、1日数百円程度なのでYouやっちゃいなよ！みたいな感じ</li>
</ul>
</li>
</ul>
<h2 id="チューニングの進め方">チューニングの進め方</h2>
<h3 id="1-課題の理解">1. 課題の理解</h3>
<ul>
<li>レギュレーションや説明をよく読む
<ul>
<li>スコアの算出方法、失格条件は特に注意</li>
</ul>
</li>
<li>実際に動いているアプリケーションを見てみる</li>
<li>とりあえずベンチ動かす
<ul>
<li>チューニングしていなくてもベンチ取る</li>
<li>ちゃんと動いているかを確認する</li>
</ul>
</li>
</ul>
<h3 id="2-プロファイリング">2. プロファイリング</h3>
<ul>
<li>ログ解析や負荷確認</li>
<li>ベンチツールの挙動を把握する
<ul>
<li>アクセス頻度の高い所を優先的にチューニングする</li>
<li>重いけどスコアに関係ない部分は無視できるかも</li>
<li><a href="https://github.com/tagomoris/Apache-Log-Parser/blob/master/bin/analyze_apache_logs">analyze_apache_logs</a>や<a href="https://github.com/matsuu/kataribe">kataribe</a>を利用する</li>
</ul>
</li>
<li>mysql slow log解析
<ul>
<li>クエリの実行回数と頻度を見る</li>
<li><a href="https://www.percona.com/doc/percona-toolkit/2.2/pt-query-digest.html">pt-query-digest</a>を使う</li>
</ul>
</li>
<li>アプリケーションのプロファイリング
<ul>
<li>straceでシステムコールレベルの解析</li>
<li>tcpdumpで通信の解析</li>
</ul>
</li>
<li>サーバの負荷
<ul>
<li>top, iftop, iotop, dstat, &hellip;</li>
</ul>
</li>
</ul>
<h3 id="3-サーバ構成の把握">3. サーバ構成の把握</h3>
<ul>
<li>どんなミドルウェアがいるのか</li>
<li>どのポートが使われているのか</li>
</ul>
<h3 id="4-チューニングの方向性を決める">4. チューニングの方向性を決める</h3>
<ul>
<li>CPUの気持ちになり、コンテキストスイッチを減らす
<ul>
<li>不要な参照・通信・プロセスをとにかく減らす</li>
</ul>
</li>
</ul>
<h2 id="チューニングのヒント">チューニングのヒント</h2>
<ul>
<li>重い処理を把握し、減らせないか考える
<ul>
<li>外部プロセス</li>
<li>HTML Templateレンダリング</li>
<li>Text, Image変換処理</li>
<li>DB, Cacheへの接続</li>
</ul>
</li>
<li>B-Treeを意識しながらDBのチューニングをする
<ul>
<li>Primary keyとSecondary keyの挙動を把握しておく</li>
</ul>
</li>
<li>不要なデータのioを最小限にする
<ul>
<li>すぐに捨てるようなデータはなるべく読み込まない</li>
<li><a href="http://www.slideshare.net/kazeburo/isucon-summerclass2014action2final">ISUCONで学ぶ Webアプリケーションのパフォーマンス向上のコツ 実践編 完全版</a>のP49あたりの話</li>
</ul>
</li>
</ul>

    <hr class="my-0 py-0" />
  </article>
  <nav class="flex flex-col justify-between md:flex-row">
    
      <a class="py-4 text-left" href="https://kobtea.net/posts/2015/05/18/scala-future-recover/"
        ><i class="fas fa-caret-left"></i>&nbsp;[Scala] Future#recoverを使って例外処理する</a
      >
    
    
      <a class="py-4 text-right" href="https://kobtea.net/posts/2015/08/23/yapc/"
        >YAPC::Asia Tokyo 2015 で聴いたセッションのメモや感想&nbsp;<i class="fas fa-caret-right"></i
      ></a>
    
  </nav>

    </section>
    <footer class="bg-primary-light">
  <div class="prose mx-auto max-w-screen-lg p-4">
    <div class="grid grid-cols-1 md:grid-cols-3">
      <div class="col-span-1">
        <p class="text-lg font-bold">Author</p>
        <address class="flex content-start not-italic">
          <img
            class="my-0 rounded-full"
            src="https://www.gravatar.com/avatar/0341c09395fd77b2a42ee5f8f681c24d.png"
            alt="author"
          />
          <div class="px-4">
            <strong>kobtea</strong>
            <a href="https://twitter.com/kobtea"
              ><i class="fa-brands fa-square-x-twitter fa-lg"></i
            ></a>
            <a href="https://github.com/kobtea"
              ><i class="fa-brands fa-square-github fa-lg"></i
            ></a>
            <br />
            <small>カピバラと暮らしたい</small>
          </div>
        </address>
      </div>

      <div class="col-span-2">
        
          
        
          
            <p><strong class="text-lg capitalize">tags</strong></p>
            
              <a class="" href="/tags/book"
                >#book</a
              >
            
              <a class="" href="/tags/cicd"
                >#cicd</a
              >
            
              <a class="" href="/tags/conference"
                >#conference</a
              >
            
              <a class="" href="/tags/gadget"
                >#gadget</a
              >
            
              <a class="" href="/tags/gcp"
                >#gcp</a
              >
            
              <a class="" href="/tags/github-pages"
                >#github pages</a
              >
            
              <a class="" href="/tags/grafana"
                >#grafana</a
              >
            
              <a class="" href="/tags/hardware"
                >#hardware</a
              >
            
              <a class="" href="/tags/java"
                >#java</a
              >
            
              <a class="" href="/tags/jsonnet"
                >#jsonnet</a
              >
            
              <a class="" href="/tags/kubernetes"
                >#kubernetes</a
              >
            
              <a class="" href="/tags/linux"
                >#linux</a
              >
            
              <a class="" href="/tags/markdown"
                >#markdown</a
              >
            
              <a class="" href="/tags/misc"
                >#misc</a
              >
            
              <a class="" href="/tags/monitoring"
                >#monitoring</a
              >
            
              <a class="" href="/tags/octopress"
                >#octopress</a
              >
            
              <a class="" href="/tags/opengrok"
                >#opengrok</a
              >
            
              <a class="" href="/tags/prometheus"
                >#prometheus</a
              >
            
              <a class="" href="/tags/python"
                >#python</a
              >
            
              <a class="" href="/tags/ruby"
                >#ruby</a
              >
            
              <a class="" href="/tags/scala"
                >#scala</a
              >
            
              <a class="" href="/tags/vim"
                >#vim</a
              >
            
              <a class="" href="/tags/windows"
                >#windows</a
              >
            
          
        
      </div>
    </div>

    <div class="py-2 text-center text-sm">
      <span class=""
        >Copyright © 2013-2024, kobtea | Powered by
        <a href="https://gohugo.io/">HUGO</a> | Themed with
        <a href="https://github.com/kobtea/hugo-theme-capybara"
          >Capybara</a
        ></span
      >
    </div>
  </div>
</footer>

  
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-LR0PW9ZWER"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-LR0PW9ZWER');
        }
      </script>
    
  




  </body>
</html>
