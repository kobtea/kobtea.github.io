<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>MBAにRuby環境を作る - kobtea.net</title>
    <meta name="description" content="eternal jojaku">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MBAにRuby環境を作る"/>
<meta name="twitter:description" content="$ sw_vers ProductName: Mac OS X ProductVersion: 10.8.4 BuildVersion: 12E3067 rbenvのreadmeにそってやる。 PATHについて解説までしてくれるとかマジ天使。 rbenvのインストール # homebrewを最新の状態に $ brew update $ brew upgrade # rbenvをインストール"/>


    <link type="text/css" rel="stylesheet" href="https://kobtea.net/css/main.css">
    <link type="text/css" rel="stylesheet" href="https://kobtea.net/css/syntax.css">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <script src="https://kobtea.net/js/main.js"></script>
</head>

<body>
<header>
    <nav class="navbar is-primary">
        <div class="container">
            <div class="navbar-brand">
                <a class="navbar-item" href="https://kobtea.net/"><strong>kobtea.net</strong></a>

                <a class="navbar-burger burger" data-target="navigation">
                    <span></span>
                    <span></span>
                    <span></span>
                </a>
            </div>

            <div id="navigation" class="navbar-menu">
                <div class="navbar-end">
                    
                    <a class="navbar-item" href="/posts">archives</a>
                    
                    <a class="navbar-item" href="/posts/index.xml">rss</a>
                    
                </div>
            </div>
        </div>
    </nav>
</header>

<section id="wrapper" class="section">
    <div class="container">
<article>
    <section class="hero">
        <div class="hero-body">
            <h1 class="title">MBAにRuby環境を作る</h1>
        </div>
    </section>

    <i class="fas fa-calendar-alt"></i>
    <time>2013-09-23 00:17</time>
    <span>&nbsp;</span>
    <i class="fas fa-tags"></i>
    
    <a class="cp-tag" href="/tags/ruby">#Ruby</a>
    
    <aside>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#rbenvのインストール">rbenvのインストール</a></li>
    <li><a href="#rbenv-default-gemsをインストール">rbenv-default-gemsをインストール</a></li>
    <li><a href="#追記">追記</a></li>
  </ul>
</nav>
    </aside>

    <div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ sw_vers
ProductName:    Mac OS X
ProductVersion: 10.8.4
BuildVersion:   12E3067
</code></pre></div><p><a href="https://github.com/sstephenson/rbenv">rbenv</a>のreadmeにそってやる。<br>
PATHについて解説までしてくれるとかマジ天使。</p>
<h2 id="rbenvのインストール">rbenvのインストール</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># homebrewを最新の状態に</span>
$ brew update
$ brew upgrade

<span class="c1"># rbenvをインストール</span>
$ brew install <span class="nv">rbenv</span>
<span class="o">==</span>&gt; Downloading https://github.com/sstephenson/rbenv/archive/v0.4.0.tar.gz
<span class="c1">######################################################################## 100.0%</span>
<span class="o">==</span>&gt; Caveats
To use Homebrew<span class="err">&#39;</span>s directories rather than ~/.rbenv add to your profile:
  <span class="nb">export</span> <span class="nv">RBENV_ROOT</span><span class="o">=</span>/usr/local/var/rbenv

To <span class="nb">enable</span> shims and autocompletion add to your profile:
  <span class="k">if</span> which rbenv &gt; /dev/null<span class="p">;</span> <span class="k">then</span> <span class="nb">eval</span> <span class="s2">&#34;</span><span class="k">$(</span>rbenv init -<span class="k">)</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">fi</span>
<span class="o">==</span>&gt; Summary
🍺  /usr/local/Cellar/rbenv/0.4.0: <span class="m">31</span> files, 152K, built in <span class="m">2</span> seconds

<span class="c1"># ruby-buildをインストール</span>
$ brew install ruby-build
<span class="c1">######################################################################## 100.0%</span>
<span class="o">==</span>&gt; ./configure --prefix<span class="o">=</span>/usr/local/Cellar/autoconf/2.69
<span class="o">==</span>&gt; make install
🍺  /usr/local/Cellar/autoconf/2.69: <span class="m">69</span> files, 2.0M, built in <span class="m">8</span> <span class="nv">seconds</span>
<span class="o">==</span>&gt; Installing ruby-build
<span class="o">==</span>&gt; Downloading https://github.com/sstephenson/ruby-build/archive/v20130907.tar.gz
<span class="c1">######################################################################## 100.0%</span>
<span class="o">==</span>&gt; ./install.sh
🍺  /usr/local/Cellar/ruby-build/20130907: <span class="m">83</span> files, 368K, built in <span class="m">2</span> seconds
</code></pre></div><p>profileとかrcに以下を追記する。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">echo</span> <span class="s1">&#39;if which rbenv &gt; /dev/null; then eval &#34;$(rbenv init -)&#34;; fi&#39;</span> &gt;&gt; ~/.zprofile
$ <span class="nb">source</span> ~/.zprofile
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ rbenv --help
rbenv 0.4.0
Usage: rbenv &lt;command&gt; <span class="o">[</span>&lt;args&gt;<span class="o">]</span>

Some useful rbenv commands are:
   commands    List all available rbenv commands
   <span class="nb">local</span>       Set or show the <span class="nb">local</span> application-specific Ruby version
   global      Set or show the global Ruby version
   shell       Set or show the shell-specific Ruby version
   install     Install a Ruby version using the ruby-build plugin
   uninstall   Uninstall a specific Ruby version
   rehash      Rehash rbenv shims <span class="o">(</span>run this after installing executables<span class="o">)</span>
   version     Show the current Ruby version and its origin
   versions    List all Ruby versions available to rbenv
   which       Display the full path to an executable
   whence      List all Ruby versions that contain the given executable

See <span class="sb">`</span>rbenv <span class="nb">help</span> &lt;command&gt;<span class="err">&#39;</span> <span class="k">for</span> information on a specific command.
For full documentation, see: https://github.com/sstephenson/rbenv#readme
</code></pre></div><h2 id="rbenv-default-gemsをインストール">rbenv-default-gemsをインストール</h2>
<p>ついでに<a href="https://github.com/sstephenson/rbenv-default-gems">rbenv-default-gems</a>を入れておく。<br>
<code>rbenv install &lt;version&gt;</code>でRubyをインストールする際に、一緒に必要なgemを入れてくれる。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">echo</span> <span class="s1">&#39;bundler&#39;</span> &gt;&gt; ~/.rbenv/default-gems
</code></pre></div><p>ひとまずbundlerだけでいいかな。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 一応homebrewを再度更新</span>
$ brew update
$ brew upgrade

<span class="c1"># ruby 2.0をインストール</span>
$ rbenv install 2.0.0-p247
Downloading openssl-1.0.1e.tar.gz...
-&gt; https://www.openssl.org/source/openssl-1.0.1e.tar.gz
Installing openssl-1.0.1e...

BUILD FAILED

Inspect or clean up the working tree at /var/folders/fz/6spm20xn2n34zk3rhc5q1b6c0000gn/T/ruby-build.20130922145805.39114
Results logged to /var/folders/fz/6spm20xn2n34zk3rhc5q1b6c0000gn/T/ruby-build.20130922145805.39114.log

Last <span class="m">10</span> log lines:
<span class="nv">RANLIB</span>        <span class="o">=</span><span class="nb">true</span>
<span class="nv">ARFLAGS</span>       <span class="o">=</span>
<span class="nv">PERL</span>          <span class="o">=</span>/usr/bin/perl
SIXTY_FOUR_BIT_LONG mode
DES_UNROLL used
DES_INT used
RC4 uses uchar
RC4_CHUNK is unsigned long
sh: make: <span class="nb">command</span> not found
/usr/local/bin/ruby-build: line 387: make: <span class="nb">command</span> not found
</code></pre></div><p>makeコマンドがないぽい。<br>
command line toolsが入ってなかった。</p>
<pre><code>Xcode -&gt; Preferences -&gt; Downloads -&gt; Command Line Tools -&gt; Install
</code></pre><p>リトライ。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ rbenv install 2.0.0-p247
Downloading openssl-1.0.1e.tar.gz...
-&gt; https://www.openssl.org/source/openssl-1.0.1e.tar.gz
Installing openssl-1.0.1e...
Installed openssl-1.0.1e to /Users/kobtea/.rbenv/versions/2.0.0-p247

Downloading ruby-2.0.0-p247.tar.gz...
-&gt; http://cache.ruby-lang.org/pub/ruby/2.0/ruby-2.0.0-p247.tar.gz
Installing ruby-2.0.0-p247...
Installed ruby-2.0.0-p247 to /Users/kobtea/.rbenv/versions/2.0.0-p247

ERROR:  While executing gem ... <span class="o">(</span>Gem::FilePermissionError<span class="o">)</span>
    You don<span class="s1">&#39;t have write permissions into the /Library/Ruby/Gems/1.8 directory.
</span><span class="s1">rbenv: error installing gem `bundler&#39;</span>
</code></pre></div><p>今度は権限がない。<br>
<a href="https://github.com/sstephenson/rbenv-default-gems/issues/7">Issue</a>に載っていた。<br>
どうやら環境変数に<code>$RBENV_ROOT</code>が必要らしい。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ rbenv root
</code></pre></div><p>で表示されたパスを.zprofileとかに書く。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">echo</span> <span class="s1">&#39;export RBENV_ROOT=$HOME/.rbenv&#39;</span> &gt;&gt; ~/.zprofile
$ <span class="nb">source</span> ~/.zprofile
</code></pre></div><p>リトライ。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ rbenv install 2.0.0-p247
rbenv: /Users/kobtea/.rbenv/versions/2.0.0-p247 already exists
<span class="k">continue</span> with installation? <span class="o">(</span>y/N<span class="o">)</span> y
Downloading openssl-1.0.1e.tar.gz...
-&gt; https://www.openssl.org/source/openssl-1.0.1e.tar.gz
Installing openssl-1.0.1e...
Installed openssl-1.0.1e to /Users/kobtea/.rbenv/versions/2.0.0-p247

Downloading ruby-2.0.0-p247.tar.gz...
-&gt; http://cache.ruby-lang.org/pub/ruby/2.0/ruby-2.0.0-p247.tar.gz
Installing ruby-2.0.0-p247...
Installed ruby-2.0.0-p247 to /Users/kobtea/.rbenv/versions/2.0.0-p247

Fetching: bundler-1.3.5.gem <span class="o">(</span>100%<span class="o">)</span>
Successfully installed bundler-1.3.5
Parsing documentation <span class="k">for</span> bundler-1.3.5
Installing ri documentation <span class="k">for</span> bundler-1.3.5
<span class="m">1</span> gem installed
</code></pre></div><p>できた。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># ruby, gemのパスが$RBENV_ROOT以下に向いているか確認</span>
$ rbenv rehash
$ rbenv versions
* system <span class="o">(</span><span class="nb">set</span> by /Users/kobtea/.rbenv/version<span class="o">)</span>
  2.0.0-p247
$ which ruby
/Users/kobtea/.rbenv/shims/ruby
$ which gem
/Users/kobtea/.rbenv/shims/gem

<span class="c1"># システムデフォルトのバージョン確認</span>
$ ruby --version
ruby 1.8.7 <span class="o">(</span>2012-02-08 patchlevel 358<span class="o">)</span> <span class="o">[</span>universal-darwin12.0<span class="o">]</span>
$ gem --version
1.3.6

<span class="c1"># デフォルトのバージョンを2.0に変更</span>
$ rbenv global 2.0.0-p247
$ rbenv versions
  system
* 2.0.0-p247 <span class="o">(</span><span class="nb">set</span> by /Users/kobtea/.rbenv/version<span class="o">)</span>

$ ruby --version
ruby 2.0.0p247 <span class="o">(</span>2013-06-27 revision 41674<span class="o">)</span> <span class="o">[</span>x86_64-darwin12.4.1<span class="o">]</span>
$ gem --version
2.0.3
</code></pre></div><p>こんにちはRuby。</p>
<h2 id="追記">追記</h2>
<p>Macデフォルトのreadlineは使わないほうがいいらしい。<br>
<code>rbenv install</code>する際にはhomebrewで入れたreadline, opensslを指定する。<br>
指定しない場合、Macだとirbでマルチバイトが使えない。<br>
<a href="/blog/2013/09/22/use-multibytes-on-ruby">irbで日本語が文字化けする</a></p>


    <hr/>
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "kobtea" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
<nav class="cp-pagination">
    
    <a class="pagination-previous" href="https://kobtea.net/posts/2013/09/22/use-multibytes-on-ruby/"><i class="fas fa-caret-left"></i>&nbsp;irbで日本語が文字化けする</a>
    
    
    <a class="pagination-next" href="https://kobtea.net/posts/2013/09/23/setup-octopress/">Octopress &#43; Github Pagesな環境構築&nbsp;<i class="fas fa-caret-right"></i></a>
    
</nav>

    </div>
</section>
<footer class="footer">
    <div class="container">
        <div class="columns">
            <div class="column is-4">
                <strong class="is-size-5">Author</strong>
                <div class="media">
                    <figure class="media-left">
                        <img src="https://www.gravatar.com/avatar/0341c09395fd77b2a42ee5f8f681c24d.png">
                    </figure>
                    <div class="media-content">
                        <strong>kobtea</strong>
                        <a href="https://twitter.com/kobtea"><i class="fab fa-twitter-square fa-lg"></i></a>
                        <a href="https://github.com/kobtea"><i class="fab fa-github-square fa-lg"></i></a>
                        <br/>
                        <small>カピバラと暮らしたい</small>
                    </div>
                </div>
            </div>
            <div class="column is-8">
                
                
                
                
                <p><strong class="is-capitalized is-size-5">tags</strong></p>
                
                <a class="cp-tag" href="/tags/book">#book</a>
                
                <a class="cp-tag" href="/tags/conference">#conference</a>
                
                <a class="cp-tag" href="/tags/gadget">#gadget</a>
                
                <a class="cp-tag" href="/tags/gcp">#gcp</a>
                
                <a class="cp-tag" href="/tags/github-pages">#github-pages</a>
                
                <a class="cp-tag" href="/tags/hardware">#hardware</a>
                
                <a class="cp-tag" href="/tags/java">#java</a>
                
                <a class="cp-tag" href="/tags/linux">#linux</a>
                
                <a class="cp-tag" href="/tags/markdown">#markdown</a>
                
                <a class="cp-tag" href="/tags/misc">#misc</a>
                
                <a class="cp-tag" href="/tags/monitoring">#monitoring</a>
                
                <a class="cp-tag" href="/tags/octopress">#octopress</a>
                
                <a class="cp-tag" href="/tags/opengrok">#opengrok</a>
                
                <a class="cp-tag" href="/tags/python">#python</a>
                
                <a class="cp-tag" href="/tags/ruby">#ruby</a>
                
                <a class="cp-tag" href="/tags/scala">#scala</a>
                
                <a class="cp-tag" href="/tags/vim">#vim</a>
                
                <a class="cp-tag" href="/tags/windows">#windows</a>
                
                
                
            </div>
        </div>
        <p class="has-text-centered">Copyright © 2013-2019, kobtea | Powered by <a href="https://gohugo.io/">HUGO</a> | Themed with <a href="https://github.com/kobtea/hugo-theme-capybara">Capybara</a></p>
    </div>
</footer>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-60750954-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</body>
</html>
